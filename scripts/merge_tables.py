import sys,math,pandas as pd;assert len(sys.argv)==3;P=lambda f:(lambda L:pd.DataFrame([[c.strip()for c in x.split('|')if c.strip()]for x in L[2:]],columns=[h.strip()for h in L[0].split('|')if h.strip()]))(list(map(str.strip,filter(None,open(f,encoding='utf-8')))));d1,d2=P(sys.argv[1]),P(sys.argv[2]);d1["Received (Server)"]=d1["Source IP (Server)"].map(lambda x:"ðŸ«¡"if pd.notna(x)else"ðŸ¤¯");d1["Protocol Number"],d2["Protocol Number"]=d1["Protocol Number"].astype(int),d2["Protocol Number"].astype(int);m=pd.merge(d1,d2,on="Protocol Number",how="outer",suffixes=("_recv","_send"));m["Received (Server)"]=m["Received (Server)"].fillna("ðŸ¤¯");m["Time (Î¼s) (Client)"],m["Time (Î¼s) (Server)"]=m["Time (Î¼s) (Client)"].replace("-",0).replace(math.nan,0).astype(int),m["Time (Î¼s) (Server)"].replace("-",0).replace(math.nan,0).astype(int);m["Time difference (Î¼s)"]=m["Time (Î¼s) (Server)"]-m["Time (Î¼s) (Client)"];m["Time difference (Î¼s)"]=m["Time difference (Î¼s)"].map(lambda x:x if x>0 else math.nan);print(m.drop(columns=["Time (Î¼s) (Server)","Time (Î¼s) (Client)"]).sort_values("Protocol Number").to_markdown(index=False))